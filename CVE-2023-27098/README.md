
<h1>CVE-2023-27098: Tapo C200 Android Application Hardcoded Secrets</h1>
<h2 tabindex="-1" dir="auto"><a id="user-content-information" class="anchor" aria-hidden="true" tabindex="-1" href="#information"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Information</h2>
<p dir="auto"><strong>Description:</strong>The presence of hardcoded secrets such as API tokens and passwords within the TP-Link Tapo c200 android application give access to Tapo c200 camera cloud store <br>
<strong>Versions Affected:</strong> &lt; 2.11.44 <br>
<strong>Version Fixed:</strong> 3.1.514  <br>
<strong>Researcher:</strong> Tomas Castro Rojas (<a href="https://www.linkedin.com/in/tomas-castro1337/" rel="nofollow">https://www.linkedin.com/in/tomas-castro1337</a>)<br>
<strong>Product Link:</strong> <a href="https://play.google.com/store/apps/details?id=com.tplink.iot&hl=en&gl=US" rel="nofollow">https://play.google.com/store/apps/details?id=com.tplink.iot&hl=en&gl=US</a><br>
<strong>CVE.org Link:</strong> <a href="https://www.cve.org/CVERecord?id=CVE-2023-27098" rel="nofollow">https://www.cve.org/CVERecord?id=CVE-2023-27098</a></p>
<h2 tabindex="-1" dir="auto"><a id="user-content-proof-of-concept-exploit" class="anchor" aria-hidden="true" tabindex="-1" href="#proof-of-concept-exploit"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Proof-of-Concept Exploit</h2>
<h3 tabindex="-1" dir="auto"><a id="user-content-description" class="anchor" aria-hidden="true" tabindex="-1" href="#description"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Description</h3>
<p dir="auto"> The TP-Link android application Tapo C200 2.11.44 which is used to manage the Tapo c200 camera contains hardcoded API tokens, posing a severe risk of unauthorized access to the internal cloud service where videos and photos from Tapo C200 are stored. This vulnerability raises concerns about potential privacy breaches, as malicious actors could exploit this flaw to access sensitive Tapo users data.</p>
<h3 tabindex="-1" dir="auto"><a id="user-content-usageexploitation" class="anchor" aria-hidden="true" tabindex="-1" href="#usageexploitation"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a>Usage/Exploitation</h3>
<p dir="auto">Using an APK decompiler such as apktool, we unpack the application. This creates an "application" directory with assets, resources, and compiled code. At this point, we need to convert Dex files to Java files to check the application code for the api tokens and passwords just as those in NBUCloudRepository.java.
  <img width="967" alt="Screen Shot 2023-12-28 at 3 18 27 PM" src="https://github.com/c0d3x27/CVEs/assets/3503307/d6ea2989-1954-4afc-b5b5-c21416cbd1b4">

</p>
